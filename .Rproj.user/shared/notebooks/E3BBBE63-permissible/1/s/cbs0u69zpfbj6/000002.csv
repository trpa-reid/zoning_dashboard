"0","area.plan<-read_excel(""H:/land_use/permissible_use/Area Plan Use Table.xlsx"", sheet=""Sheet3"", skip=2)"
"0","area_plan_tab<-area.plan %>% gather(area,use_clean,4:103) %>%"
"0"," separate(area, c(""area_name"", ""sub_area_name""), sep=""!"") %>%"
"0","  separate(sub_area_name, c(""name"", ""id""), sep=""#"") %>%"
"0","  rename(use1=major_use_1,use2=major_use_2,use3=primary_use, use=use_clean) %>%"
"0","  mutate(area_type=""Area Plan"") %>%"
"0","  select(id, area_type, use1, use2,use3,use)"
"0",""
"0","area_gis <- st_read(""H:/land_use/permissible_use/zoning.gdb"",""area_plans_gis"")"
"1","Reading layer `"
"1","area_plans_gis"
"1","' from data source `"
"1","H:\land_use\permissible_use\zoning.gdb"
"1","' using driver `"
"1","OpenFileGDB"
"1","'"
"1","
"
"1","Simple feature collection with 95 features and 28 fields"
"1","
"
"1","geometry type:  MULTIPOLYGON
"
"1","dimension:      XY
"
"1","bbox:           "
"1","xmin: 737668.9 ymin: 4302799 xmax: 766732.2 ymax: 4353464"
"1","
"
"1","epsg (SRID):    26910
"
"1","proj4string:    +proj=utm +zone=10 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs
"
"0","tvap_os <- st_read(""H:/land_use/permissible_use/zoning.gdb"",""tvap_os"") %>%"
"0","  mutate(id=""Open Space-TC-OS"", Local_Plan_Name=""TAHOE VALLEY AREA PLAN"") %>%"
"0","  select(id, Local_Plan_Name)"
"1","Reading layer `"
"1","tvap_os"
"1","' from data source `"
"1","H:\land_use\permissible_use\zoning.gdb"
"1","' using driver `"
"1","OpenFileGDB"
"1","'"
"1","
"
"1","Simple feature collection with 1 feature and 73 fields"
"1","
"
"1","geometry type:  MULTIPOLYGON
"
"1","dimension:      XY
"
"1","bbox:           "
"1","xmin: 759218 ymin: 4310950 xmax: 760484.1 ymax: 4312132"
"1","
"
"1","epsg (SRID):    26910
"
"1","proj4string:    +proj=utm +zone=10 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs
"
"0","special <- st_read(""H:/land_use/permissible_use/zoning.gdb"",""special"") %>%"
"0","  mutate(id=paste(SPECIAL_AREA_NAME, REGIONAL_LAND_USE, sep=""-"")) %>%"
"0","  select(id, PLAN_NAME) %>%"
"0","  rename(Local_Plan_Name=PLAN_NAME)"
"1","Reading layer `"
"1","special"
"1","' from data source `"
"1","H:\land_use\permissible_use\zoning.gdb"
"1","' using driver `"
"1","OpenFileGDB"
"1","'"
"1","
"
"1","Simple feature collection with 4 features and 23 fields"
"1","
"
"1","geometry type:  MULTIPOLYGON
"
"1","dimension:      XY
"
"1","bbox:           "
"1","xmin: 749041.1 ymin: 4341107 xmax: 756598.9 ymax: 4348299"
"1","
"
"1","epsg (SRID):    26910
"
"1","proj4string:    +proj=utm +zone=10 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs
"
"0","gis<-area_gis %>% mutate(id=case_when(Local_Plan_Name == ""PLACER COUNTY TAHOE BASIN AREA PLAN"" ~ paste(Subdistrict,Zoning,sep=""-""), TRUE ~ paste(Zoning_Description, Zoning, sep=""-""))) %>%"
"0","  select(id, Local_Plan_Name)"
"0","gis<-st_difference(gis, st_union(st_combine(tvap_os)))"
"2","attribute variables are assumed to be spatially constant throughout all geometries"
"0","final<-st_difference(gis, st_union(st_combine(special)))"
"2","attribute variables are assumed to be spatially constant throughout all geometries"
"0","gis_area_plan <- rbind(final, special,tvap_os) %>% st_transform(crs=4326) %>%"
"0","  arrange(Local_Plan_Name, id) %>% "
"0","  mutate(id_final= paste(""area_plan"",row_number(),  sep=""_""), plan_id=NA_character_, "
"0","         special_area_name=case_when(id %in% c(""LAKE FOREST COMMERCIAL SA #1-COM/PS"","
"0","                                                      ""LAKE FOREST COMMERCIAL SA #2-COM/PS"","
"0","                                                      ""MARTIS PEAK SA #1-CONS"","
"0","                                                      ""NORTH TAHOE HIGH SCHOOL SA#1-REC"") ~ id,"
"0","                                     TRUE ~ NA_character_), "
"0","         special_area_id=case_when(id %in% c(""LAKE FOREST COMMERCIAL SA #1-COM/PS"","
"0","                                                      ""MARTIS PEAK SA #1-CONS"","
"0","                                                      ""NORTH TAHOE HIGH SCHOOL SA#1-REC"") ~ ""1"","
"0","                                   id == ""LAKE FOREST COMMERCIAL SA #2-COM/PS"" ~ ""2"","
"0","                                     TRUE ~ NA_character_)) %>%"
"0","  rename(plan_name=id, id=id_final, area_plan_name=Local_Plan_Name) %>%"
"0","  mutate(area_plan_name=as.character(area_plan_name), plan_type=""Area Plan"") %>%"
"0","  select(id, plan_id, plan_name, special_area_name, special_area_id, area_plan_name, plan_type)"
