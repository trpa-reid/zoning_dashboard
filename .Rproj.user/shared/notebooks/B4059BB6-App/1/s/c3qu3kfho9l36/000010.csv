"0","library(tidyverse)"
"0","library(readxl)"
"0","library(sf)"
"0","library(shiny)"
"0","library(leaflet)"
"0","library(shinydashboard)"
"0","library(DT)"
"0","library(rsconnect)"
"0",""
"0","# read in table"
"0","uses_final<-read.csv(""uses_final.csv"", stringsAsFactors = F)"
"0",""
"0","# read in GIS"
"0","gis <- st_read(""."", ""local_plan_zoning_sde"", stringsAsFactors = FALSE) %>%"
"0","  st_transform(crs=4326) %>%"
"0","  mutate(Local_Plan_old=Local_Plan, Local_Plan=case_when(Plan_Type==""AREA PLAN"" ~ Subdistric, TRUE ~ Local_Plan),"
"0","         Local_Plan=toupper(Local_Plan))"
"1","Reading layer `"
"1","local_plan_zoning_sde"
"1","' from data source `"
"1","H:\land_use\permissible_use\use_dashboard\use_dashboard"
"1","' using driver `"
"1","ESRI Shapefile"
"1","'"
"1","
"
"1","Simple feature collection with 267 features and 29 fields"
"1","
"
"1","geometry type:  MULTIPOLYGON
"
"1","dimension:      XY
"
"1","bbox:           "
"1","xmin: 737668.9 ymin: 4290898 xmax: 770952.9 ymax: 4357303"
"1","
"
"1","epsg (SRID):    26910
"
"1","proj4string:    +proj=utm +zone=10 +datum=NAD83 +units=m +no_defs
"
"0","  "
"0","matching<-data.frame(unique(uses_final$area_name)) %>% mutate(table1=""uses final"") %>% "
"0","  left_join(data.frame(unique(gis$Local_Plan)) %>% mutate(table2=""gis""), by=c(""unique.uses_final.area_name.""=""unique.gis.Local_Plan."")) %>%"
"0","  filter(!is.na(table1) & !is.na(table2)) %>% select(1)"
"2","Column `unique.uses_final.area_name.`/`unique.gis.Local_Plan.` joining factors with different levels, coercing to character vector"
"0","shinyApp("
"0","ui <- dashboardPage(skin=""green"","
"0","  dashboardHeader(title=""Permissible Uses"",titleWidth = 500),"
"0","  dashboardSidebar("
"0","      selectInput(inputId = ""pas_name"",label=""SELECT AREA:"", multiple=F,  choices=sort(as.vector(matching$unique.uses_final.area_name.))),"
"0","      selectInput(inputId = ""parcel"", label=""SELECT PARCEL:"", choices = parcel$APN)),"
"0","   dashboardBody("
"0","     fluidRow("
"0","       box(dataTableOutput(""pas_table"")),"
"0","              box(leafletOutput(""map"")))"
"0","  )"
"0","),"
"0","server <- function(input, output) {"
"0","  output$pas_table <- renderDataTable("
"0","   datatable(uses_final %>% filter(area_name %in% as.vector(matching$unique.uses_final.area_name.)) %>%"
"0","     filter(area_name %in% input$pas_name) %>%"
"0","      filter(use_clean %in% c(""Allowed"",""Special Use"")) %>%"
"0","      select(area_name, major_use_1, major_use_2, primary_use, use_clean),"
"0","        options=list(pageLength=10), colnames = c(""Area Name"",""Use Category"",""Use Sub-Category"",""Use"", ""Allowed""),"
"0","     rownames=F)"
"0","  )"
"0","  output$map <- renderLeaflet({"
"0","    gis %>% filter(Local_Plan %in% input$pas_name) %>% leaflet() %>% addPolygons(popup=paste0(input$pas_name)) %>% addTiles()"
"0","  })"
"0","  }"
"0",")"
"2","
Listening on http://127.0.0.1:4048
"
